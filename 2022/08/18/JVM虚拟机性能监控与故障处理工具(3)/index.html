<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>JVM虚拟机性能监控与故障处理工具(3) | 清河水温龙井茶</title><meta name="author" content="李文若"><meta name="copyright" content="李文若"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1.概述经过前面两章对于虚拟机内存分配与回收技术各方面的介绍，相信读者已经建立了 一个比较完整的理论基础。理论总是作为指导实践的工具，能把这些知识投入到实际工 作中才是我们的最终目的。接下来的两章，我们将从实践的角度去了解虚拟机内存管理 的世界。   给一个系统定位问题的时候，知识、经验是关键基础，数据是依据，工具是运用 知识处理数据的手段。这里说的数据包括：运行日志、异常堆栈、GC日志、线程快照"><meta property="og:type" content="article"><meta property="og:title" content="JVM虚拟机性能监控与故障处理工具(3)"><meta property="og:url" content="http://blog.buretuzi.online/2022/08/18/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)/index.html"><meta property="og:site_name" content="清河水温龙井茶"><meta property="og:description" content="1.概述经过前面两章对于虚拟机内存分配与回收技术各方面的介绍，相信读者已经建立了 一个比较完整的理论基础。理论总是作为指导实践的工具，能把这些知识投入到实际工 作中才是我们的最终目的。接下来的两章，我们将从实践的角度去了解虚拟机内存管理 的世界。   给一个系统定位问题的时候，知识、经验是关键基础，数据是依据，工具是运用 知识处理数据的手段。这里说的数据包括：运行日志、异常堆栈、GC日志、线程快照"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://image.buretuzi.online/blog/article/article-background/wallhaven-x61vml.jpg"><meta property="article:published_time" content="2022-08-18T11:52:00.000Z"><meta property="article:modified_time" content="2025-05-13T09:14:30.666Z"><meta property="article:author" content="李文若"><meta property="article:tag" content="JVM"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://image.buretuzi.online/blog/article/article-background/wallhaven-x61vml.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://blog.buretuzi.online/2022/08/18/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="/pluginsSrc/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="/pluginsSrc/@fancyapps/ui/dist/fancybox.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"top-right"},source:{justifiedGallery:{js:"/pluginsSrc/flickr-justified-gallery/dist/fjGallery.min.js",css:"/pluginsSrc/flickr-justified-gallery/dist/fjGallery.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"JVM虚拟机性能监控与故障处理工具(3)",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2025-05-13 09:14:30"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/mouseMove.css"><link rel="stylesheet" href="/css/navigation.css"><link rel="stylesheet" href="/css/Scrollbar.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/rightmenu.css"><link rel="stylesheet" href="/css/iconfont.css"><link rel="stylesheet" href="/css/Progressbar.css"><link rel="stylesheet" href="/css/footer.css"><link rel="stylesheet" href="/css/footerIcon/iconfont.css"><script rel="stylesheet" href="/css/footerIcon/iconfont.js"></script><link rel="stylesheet" href="/css/mouse.css"><link rel="stylesheet" href="/css/doublecolumn.css"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/player/aplayer.css"><link rel="stylesheet" href="/css/leftMenu.css"><link rel="stylesheet" href="/css/twikoo_beautify.css"><link rel="stylesheet" href="/css/about.css"><script defer charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script defer src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script><script defer src="/js/51La.js"></script><link rel="stylesheet" href="/css/categorybar.css"><link rel="stylesheet" href="https://image.buretuzi.online/blog/article/document/clock.min.css"><link rel="stylesheet" href="https://image.buretuzi.online/blog/article/document/runtime.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="/css/swiper/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="/css/swiper/swiperstyle.css" media="print" onload='this.media="all"'><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script>const preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",(()=>{preloader.endLoading()})),document.addEventListener("pjax:send",(()=>{preloader.initLoading()})),document.addEventListener("pjax:complete",(()=>{preloader.endLoading()}))</script><link rel="stylesheet" href="/css/Progressbar.css"><script src="/pluginsSrc/pace-js/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/head.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">48</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope"></i> <span>留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/timeline/"><i class="fa-fw fa fa-bell"></i> <span>日志</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i> <span>菜单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fa fa-sitemap"></i> <span>关于</span></a></li><li><a class="site-page child" href="/myself/"><i class="fa-fw fa fa-id-card"></i> <span>关于我</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://github.com/luaby"><i class="fa-fw fa fa-heart"></i> <span>butterfly</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><div class="back-home-button" tabindex="-1"><i class="back-home-button-icon fas fa-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://www.cnblogs.com/liwenruo/" title="前往博客主页" target="_blank" one-link-mark="yes"><img class="back-menu-item-icon" src="data:image/png;base64,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"><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" href="http://buretuzi.online" rel="external nofollow" title="前往云盘主页" target="_blank" one-link-mark="yes"><img class="back-menu-item-icon" src="data:image/png;base64,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"><span class="back-menu-item-text">我的社区</span></a></div></div></div></div><a id="site-name" href="/"><div class="title">清河水温龙井茶</div><i class="fa-solid fa-house"></i></a></span><div class="mask-name-container"><center id="name-container"><a id="page-name" href="javascript:rmf.scrollToTop()">PAGE_NAME</a></center></div><div id="menus"><div class="nav-button" id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" type="button" title="切换背景" onclick="toggleWinbox()"><i class="fas fa-image"></i></a></div><div class="nav-button" id="darkmode_navswitch"><a class="darkmode_switchbutton" type="button" title="浅色和深色模式转换" onclick="rmf.switchDarkMode()"><i class="fas fa-adjust"></i></a></div><div class="nav-button" id="nav-totop"><a class="totopbtn"><i class="fas fa-arrow-up"></i><span id="percent" onclick="btf.scrollToDest(0,500)">0</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope"></i> <span>留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/timeline/"><i class="fa-fw fa fa-bell"></i> <span>日志</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i> <span>菜单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fa fa-sitemap"></i> <span>关于</span></a></li><li><a class="site-page child" href="/myself/"><i class="fa-fw fa fa-id-card"></i> <span>关于我</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://github.com/luaby"><i class="fa-fw fa fa-heart"></i> <span>butterfly</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">JVM虚拟机性能监控与故障处理工具(3)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-18T11:52:00.000Z" title="发表于 2022-08-18 11:52:00">2022-08-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-13T09:14:30.666Z" title="更新于 2025-05-13 09:14:30">2025-05-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java/">java</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>28分钟</span></span><span class="post-meta-separator">|</span><span data-flag-title="JVM虚拟机性能监控与故障处理工具(3)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="1-概述"><a href="#1-概述" class="headerlink" title="1.概述"></a>1.概述</h1><p>经过前面两章对于虚拟机内存分配与回收技术各方面的介绍，相信读者已经建立了 一个比较完整的理论基础。理论总是作为指导实践的工具，能把这些知识投入到实际工 作中才是我们的最终目的。接下来的两章，我们将从实践的角度去了解虚拟机内存管理 的世界。</p><p>  给一个系统定位问题的时候，知识、经验是关键基础，数据是依据，工具是运用 知识处理数据的手段。这里说的数据包括：运行日志、异常堆栈、GC日志、线程快照 (threaddump &#x2F; javacore文件)、堆转储快照(heapdump &#x2F; hprof文件)等。经常使用适当 的虚拟机监控和分析的工具可以加快我们分析数据和定位解决问题的速度，但我们在学 习工具前，也应当意识到工具永远都是知识技能的一层包装，没有什么工具是“秘密武 器”，学会了就能包治百病。</p><h1 id="2-JDK的命令行工具"><a href="#2-JDK的命令行工具" class="headerlink" title="2. JDK的命令行工具"></a>2. JDK的命令行工具</h1><p>  Java开发人员肯定都知道JDK的bin目录中有“java.exe”和“javac.exe”这两个</p><p>  命令行工具，但并非所有程序员都了解过JDK的bin目录之中其他命令行程序的作用。 每逢JDK更新版本之时，bin目录下命令行工具的数量和功能总会不知不觉地增加和增 强，bin目录的内容如图4-1所示。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%881%EF%BC%89.png"></p><center>图 4-1</center><p>  在本章中，笔者将介绍这些工具的其中一部分，主要是用于监视虚拟机和故障处理的工具。这些故障处理工具被Sun公司作为“礼物”附赠给JDK的使用者，在软件的使用说明中把它们声明为“没有技术支持并且是实验性质的”(unsupported and experimental) ®的产品，但事实上这些工具都非常稳定而且功能强大，能在处理应用程序性能问题、定位故障时发挥很大的作用。</p><p>  说起JDK的工具，读者如果比较细心的话，可能会注意到这些工具的程序体积都异常的小。假如以前没注意到，现在不妨再看看图4-1中的最后一列“大小”，各个工具的 体积基本上都稳定在27KB左右。并非JDK开发团队刻意把它们制作得如此精炼来炫耀。</p><p>  假如读者使用的是Linux版本的JDK,还会发现这些工具中很多甚至就是由Shell 脚本直接写成的，可以用vim直接打开它们。</p><p>  JDK开发团队选择采用Java代码来实现这些监控工具是有特别用意的:当应用程序部署到生产环境后，无论是直接接触物理服务器还是远程Telnet到服务器上都可能会受到限制。借助tools.jar类库里面的接口，我们可以直接在应用程序中实现功能强大的监控分析功能。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%882%EF%BC%89.png"></p><p>  需要特别说明的是，本章介绍的工具全部基于Windows平台下的JDK 1.6 ,如果JDK版本、操作系统不同，工具所支持的功能可能会有较大差别。大部分工具在JDK 1.5中就已经提供，但为了避免运行环境带来的差异和兼容性问题，建议使用JDK 1.6来验证本章介绍的内容，因为JDK 1.6的工具可以正常兼容运行于 JDK 1.5的虚拟机之上的程序，反之则不一定。表4-1中列举了 JDK主要命令行监控 工具的用途。</p><p>  注意 如果读者在工作中需要监控运行于JDK 1.5的虚拟机之上的程序，在程序启动时 请添加参数”-Dcom.sun.management.jmxremote”开启JMX管理功能，否则由于部分工具都是基于JMX的(包括下一节的可视化工具)，因此它们都将会无法使用，如果被监控程序运行于JDK 1.6的虚拟机之上，那JMX管理默认是开启的，虚拟机启动时无须再添加任何参数。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%883%EF%BC%89.png"></p><h2 id="2-1-jps-虚拟机进程状况工具"><a href="#2-1-jps-虚拟机进程状况工具" class="headerlink" title="2.1 jps :虚拟机进程状况工具"></a>2.1 jps :虚拟机进程状况工具</h2><p>JDK的很多小工具的名字都参考了 Unix命令的命名方式，jps (JVM Process Status Tool)是其中的典型。除了名字像Unix的ps命令之外，它的功能也和ps命令类似：可 以列出正在运行的虚拟机进程，并显示虚拟机执行主类(Main Class, main。函数所在 的类)的名称，以及这些进程的本地虚拟机的唯一 ID (LVMID, Local Virtual Machine Identifier)。虽然功能比较单一,但它是使用频率最高的JDK命令行工具，因为其他的 JDK工具大多须要输入它査询到的LVMID来确定要监控的是哪一个虚拟机进程。对于 本地虚拟机进程来说，LVMID与操作系统的进程ID (PID, Process Identifier)是一致的，</p><p>  使用Windows的任务管理器或Unix的ps命令也可以査询到虚拟机进程的LVMID,但 如果同时启动了多个虚拟机进程，无法根据进程名称定位时，那就只能依赖jps命令显示主类的功能才能区分了。</p><p>  jps [ options ] [ hostid ]</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%884%EF%BC%89.png"></p><p>  jps可以通过RMI协议査询开启了 RMI服务的远程虚拟机进程状态，hostid为RMI 注册表中注册的主机名。jps的其他常用选项见表4-2。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%885%EF%BC%89.png"></p><h2 id="2-2-jstat-虚拟机统计信息监视工具"><a href="#2-2-jstat-虚拟机统计信息监视工具" class="headerlink" title="2.2 jstat:虚拟机统计信息监视工具"></a>2.2 jstat:虚拟机统计信息监视工具</h2><p>jstat (JVM Statistics Monitoring Tool)是用于监视虚拟机各种运行状态信息的命令行工具。它可以显示本地或远程’虚拟机进程中的类装载、内存、垃圾收集、JIT编译等 运行数据,在没有GUI图形界面，只提供了纯文本控制台环境的服务器上，它将是运行期定位虚拟机性能问题的首选工具。</p><p>  jstat命令格式为：</p><p>  jstat [ option vmid [interval[s|ms] [count]]]</p><p>  对于命令格式中的VMID与LVMID需要特别说明一下：如果是本地虚拟机进程， VMID与LVMID是一致的，如果是远程虚拟机进程，那VMID的格式应当是：</p><p>  [protocol:）[&#x2F;&#x2F;]Ivmid[@hostname[:port]&#x2F;servername]</p><p>参数interval和count代表査询间隔和次数，如果省略这两个参数，说明只査询一 次。假设需要每250毫秒査询一次进程2764垃圾收集的状况，一共査询20次，那命令应当是：</p><p>  jstat -gc 2764 250 20</p><p>  选项option代表着用户希望査询的虚拟机信息，主要分为3类：类装载、垃圾收集和运行期编译状况，具体选项及作用请参考表4-3中的描述。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%886%EF%BC%89.png"></p><p>  jstat监视选项众多，由于版面原因无法逐一演示，这里仅举一例监视一台刚刚启动 的GlassFish v3服务器的内存状况的例子来演示如何査看监视结果。监视参数与输出结 果如代码清单4-1所示。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%887%EF%BC%89.png"></p><p>  査询结果表明：这台服务器的新生代Eden区（E,表示Eden）使用了 6.2%的空间，两个Survivor区（S0、S1,表示Survivor0. Survivor1）里面都是空的，老年代（O, 表示Old）和永久代（P,表示Permanent）则分别使用了 41.42%和47.20%的空间。程序运行以来共发生Minor GC （YGC,表示Young GC） 16次，总耗时0.105秒，发生 Full GC （FGC,表示 Full GC） 3 次，Full GC 总耗时（FGCT,表示 Full GC Time）为 0.472秒，所有GC总耗时（GCT,表示GC Time）为0.577秒。</p><p>  使用jstat工具在纯文本状态下监视虚拟机状态的变化，确实不如后面将会提到的 VisualVM等可视化的监视工具直接以图表展现的那样直观。但许多服务器管理员都习惯了在文本控制台中工作，直接在控制台中使用jstat命令依然是一种常用的监控 方式。</p><h2 id="2-3-jinfo-Java配置信息工具"><a href="#2-3-jinfo-Java配置信息工具" class="headerlink" title="2.3 jinfo : Java配置信息工具"></a>2.3 jinfo : Java配置信息工具</h2><p>jinfo （Configuration Info for Java）的作用是实时地査看和调整虚拟机的各项参数。 使用jps命令的-V参数可以査看虚拟机启动时显式指定的参数列表，但如果想知道未被 显式指定的参数的系统默认值，除了去找资料外，就只能使用jinfo的-flag选项进行査 询了（如果只限于JDK 1.6或以上版本的话，使用java -XX:+PrintFlagsFinal査看参数 默认值也是一个很好的选择），jinfo还可以使用-sysprops选项把虚拟机进程的System. getProperties（）的内容打印出来。这个命令在JDK 1.5时期已经随着Linux版的JDK发 布，当时只提供了信息査询的功能，JDK 1.6之后，jinfo在Windows和Linux平台都有 提供，并且加入了运行期修改参数的能力，可以使用-flag [+|-]name或-flag name&#x3D;value 修改一部分运行期可写的虚拟机参数值。JDK 1.6中，jinfo对于Windows平台的功能仍 然有较大的限制，只提供了最基本的-flag选项。</p><p>  jinfo命令格式：</p><p>  jinfo [ option ] pid</p><p>  执行样例：査询 CMSInitiatingOccupancyFraction 参数值。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%888%EF%BC%89.png"></p><h2 id="2-4-jmap-Java内存映像工具"><a href="#2-4-jmap-Java内存映像工具" class="headerlink" title="2.4 jmap : Java内存映像工具"></a>2.4 jmap : Java内存映像工具</h2><p>jmap （Memory Map for Java）命令用于生成堆转储快照（一般称为heapdump或 dump文件）。如果不使用jmap命令，要想获取Java堆转储快照还有一些比较“暴力”</p><p>  的手段：譬如在第2章中用过的-XX:+HeapDumpOnOutOfMemoryError参数，可以让虚拟机在OOM异常出现之后自动生成dump文件，通过-XX:+HeapDumpOnCtrlBreak参 数则可以使用[Ctrl]+[Break]键让虚拟机生成dump文件，又或者在Linux系统下通过 Kill -3命令发送进程退出信号“恐吓” 一下虚拟机，也能拿到dump文件。</p><p>  jmap的作用并不仅仅是为了获取dump文件，它还可以査询finalize执行队列，Java 堆和永久代的详细信息，如空间使用率、当前用的是哪种收集器等。</p><p>  和jinfo命令一样，jmap有不少功能在Windows平台下都是受限的，除了生成 dump文件的-dump选项和用于査看每个类的实例、空间占用统计的-histo选项所有操 作系统都提供之外，其余选项都只能在Linux &#x2F; Solaris下使用。</p><p>  jmap命令格式：</p><p>  jmap [ option ] vmid</p><p>  option选项的合法值与具体含义如表4-4所示。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%889%EF%BC%89.png"></p><p>  代码清单4-2是使用jmap生成一个正在运行的Eclipse的dump快照文件的例子, 例子中的3500是通过jps命令査询到的LVMID.</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8810%EF%BC%89.png"></p><h2 id="2-5-jhat：虚拟机堆转储快照分析工具"><a href="#2-5-jhat：虚拟机堆转储快照分析工具" class="headerlink" title="2.5 jhat：虚拟机堆转储快照分析工具"></a>2.5 jhat：虚拟机堆转储快照分析工具</h2><p>Sun JDK 提供 jhat (JVM Heap Analysis Tool)命令与 jmap 搭配使用，来分析 jmap 生成的堆转储快照。jhat内置了一个微型的https&#x2F;HTML服务器，生成dump文件的分析结果后，可以在浏览器中査看。不过实事求是地说，在实际工作中，除非笔者手上真 的没有别的工具可用，否则一般都不会去直接使用jhat命令来分析dump文件，主要原 因有二：一是一般不会在部署应用程序的服务器上直接分析dump文件，即使可以这样 做，也会尽量将dump文件拷贝到其他机器’上进行分析，因为分析工作是一个耗时而 且消耗硬件资源的过程，既然都要在其他机器上进行，就没必要受到命令行工具的限制 To另外一个原因是jhat的分析功能相对来说比较简陋，后文将会介绍到的VisualVM, 以及专业用于分析 dump 文件的 Eclipse Memory Analyzer, IBM HeapAnalyzer®等工具， 都能实现比jhat更强大更专业的分析功能。代码清单4-3演示了使用jhat分析上一节采 用jmap生成的Eclipse IDE的内存快照文件。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8811%EF%BC%89.png"></p><p>  屏幕显示Server is ready.的提示后,用户在浏览器中键入<a target="_blank" rel="noopener" href="https://localhost:7000/">https://localhost:7000/</a> 就可以看到分析结果，如图4-3所示。</p><p>  分析结果默认以包为单位进行分组显示，分析内存泄漏问题主要会使用到其中的 “Heap Histogram”(与jmap-histo功能一样)与OQL页签的功能，前者可以找到内存中总容量最大的对象，后者是标准的对象査询语言，使用类似SQL的语法对内存中的对象 进行査询统计。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8812%EF%BC%89.png"></p><h2 id="2-6-jstack-Java堆栈跟踪工具"><a href="#2-6-jstack-Java堆栈跟踪工具" class="headerlink" title="2.6 jstack : Java堆栈跟踪工具"></a>2.6 jstack : Java堆栈跟踪工具</h2><p>jstack (Stack Trace for Java)命令用于生成虚拟机当前时刻的线程快照(一般称为 threaddump或javacore文件)。线程快照就是当前虚拟机内每一条线程正在执行的方法 堆栈的集合,生成线程快照的主要目的是定位线程出现长时间停顿的原因,如线程间死锁、死循环、请求外部资源导致的长时间等待等都是导致线程长时间停顿的常见原因。 线程出现停顿的时候通过jstack来査看各个线程的调用堆栈，就可以知道没有响应的线程到底在后台做些什么事情，或者等待着什么资源。</p><p>  jstack命令格式：</p><p>  jstack [option ] vmid</p><p>  option选项的合法值与具体含义如表4-5所示。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8813%EF%BC%89.png"></p><p>  代码清单4-4是使用jstack査看Eclipse线程堆栈的例子，例子中的3500是通过jps 命令査询到的LVMID</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8814%EF%BC%89.png"></p><p>  在 JDK 1.5 中，java.lang.Thread 类新增了一个 getAllStackTraces()方法用于获取虚拟机中所有线程的StackTraceElement对象。使用这个方法可以通过简单的几行代码就完成jstack的大部分功能，在实际项目中不妨调用这个方法做个管理员页面，可以随时使用浏览器来査看线程堆栈，如代码清单4-5所示，这是笔者的一个小经验。<br> <br><img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8815%EF%BC%89.png"></p><h1 id="3-JDK的可视化工具"><a href="#3-JDK的可视化工具" class="headerlink" title="3. JDK的可视化工具"></a>3. JDK的可视化工具</h1><p>  JDK中除了提供大量的命令行工具外，还有两个功能强大的可视化工具：JConsole 和VisualVM,这两个工具是JDK的正式成员，没有被贴上”unsupported and experimental”的标签。</p><p>  其中JConsole是在JDK 1.5时期就已经提供的虚拟机监控工具，而VisualVM在 JDK 1.6 Update7中才首次发布，现在已经成为Sun (Oracle)主力推动的多合一故障处理工具。并且已经从JDK中分离出来成为可以独立发展的开源项目。</p><p>  为了避免本节的讲解成为对软件说明文档的简单翻译，笔者准备了一些代码样例， 都是笔者特意编写的反面教材。后面将会使用两款工具去监控和分析这几段代码存在的 问题，算是本节简单的实战分析。可以把在可视化工具上观察到的数据和现象与前面两章中讲解的理论知识互相印证。</p><h2 id="3-1-JConsole-Java监视与管理控制台"><a href="#3-1-JConsole-Java监视与管理控制台" class="headerlink" title="3.1 JConsole : Java监视与管理控制台"></a>3.1 JConsole : Java监视与管理控制台</h2><p>JConsole (Java Monitoring and Management Console)是一款基于 JMX 的可视化监视和管理的工具。它管理部分的功能是针对JMX MBean进行管理，由于MBean可以使用代码、中间件服务器的管理控制台或者所有符合JMX规范的软件进行访问，所以本 节中将会着重介绍JConsole监视部分的功能。</p><h3 id="（1）启动-JConsole"><a href="#（1）启动-JConsole" class="headerlink" title="（1）启动 JConsole"></a>（1）启动 JConsole</h3><p>通过JDK&#x2F;bin目录下的“jconsole.exe”启动JConsole后，将自动搜索出本机运行的 所有虚拟机进程，不需要用户自己再使用jps来査询了，如图4-4所示。双击选择其中 一个进程即可开始监控，也可以使用下面的“远程进程”功能来连接远程服务器，对远 程虚拟机进行监控。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8816%EF%BC%89.png"></p><center>图 4-4</center><p>  从图4-4中可以看到笔者的机器现在运行了一共三个本地虚拟机进程。双击任意一个进入JConsole主界面，可以看到主界面里共包括“概述”、’‘内存”、”线程”、 “类”、-VM摘要”和“MBean”六个页签，如图4-5所示。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8817%EF%BC%89.png"></p><center>图 4-5</center><p>  “概述”页签显示的是整个虚拟机主要运行数据的概览，其中包括“堆内存使用情 况”、’‘线程”、”类”、“CPU使用情况”四项信息的曲线图，这些曲线图是后面“内存”、“线程”、”类”页签的信息汇总，具体内容将在后面介绍。</p><h3 id="（2）内存监控"><a href="#（2）内存监控" class="headerlink" title="（2）内存监控"></a>（2）内存监控</h3><p>“内存”页签相当于可视化的jstat命令，用于监视受收集器管理的虚拟机内存 （Java堆和永久代）的变化趋势。我们通过运行代码清单4-6中的代码来体验一下它的 监视功能。运行时设置的虚拟机参数为：-Xms100m -Xmx100  m -XX:+UseSerialGC,这 段代码的作用是以64KB&#x2F;50毫秒的速度往Java堆中填充数据，一共填充1000次，使用 JConsole的“内存”页签进行监视，观察曲线和柱状指示图的变化。</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.intehel.demo.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FinalizeEscapeGC</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">OOMObject</span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">byte</span>[] placeholder = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">64</span>*<span class="number">1024</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unused&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">fillHeap</span><span class="params">(<span class="type">int</span> nun)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        List&lt;OOMObject&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;OOMObject&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nun; i++)&#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            list.add(<span class="keyword">new</span> <span class="title class_">OOMObject</span>());</span><br><span class="line">        &#125;</span><br><span class="line">        System.gc();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        fillHeap(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  程序运行后，在“内存”页签中可以看到内存池Eden区的运行趋势呈现折线状， 如图4-6所示。而监视范围扩大至整个堆后，会发现曲线是一条向上增长的平滑曲线。 并且从柱状图可以看到，在1000次循环执行结束，运行了 System.gc()后，虽然整个新生代Eden和Survivor区都基本被清空了，但是代表老年代的柱状图仍然保持峰值状态， 说明被填充进堆中的数据在System.gc()方法执行之后仍然存活着。分析就到此为止，提两个小问题思考一下。</p><ul><li>虚拟机启动参数只限制了 Java堆为100MB,没有指定-Xmn参数，能否从监控图中估计出新生代有多大？</li><li>为何执行了 System.gc()之后，图4-6中代表老年代的柱状图仍然显示为峰值状 态，代码需要如何调整才能让System.gc()回收掉填充到堆中的对象？</li></ul><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8818%EF%BC%89.png"></p><center>图 4-6</center><p>  问题1的答案：图4-6显示Eden空间为27328KB,因为没有设置-XX:SurvivorRadio 参数，所以Eden与Survivor空间比例为默认值8： 1,因此整个新生代空间大约为 27,328KB X 125%&#x3D;34,160KB。</p><p>  问题2的答案：System.gc()之后，空间未能回收是因为List<oomobject>list对象_仍然存活着,_fiUHeap()方法仍然没有退出，因此list对象在执行System.gc()时仍然处于作用域之内。如果把System.gc()移动到fillHeap()方法外，调用就可以回收掉全部 内存。</oomobject></p><h3 id="（3）线程监控"><a href="#（3）线程监控" class="headerlink" title="（3）线程监控"></a>（3）线程监控</h3><p>如果上面的“内存”页签相当于可视化的jstat命令的话，“线程”页签的功能则相当于可视化的jstack命令，遇到线程停顿的时候可以使用这个页签进行监控分析。前面 讲解jstack命令的时候提到过线程长时间停顿的主要原因有：等待外部资源（数据库连 接、网络资源、设备资源等）、死循环、锁等待（活锁和死锁）。通过代码清单4-7分别 演示一下这几种情况。</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.intehel.demo.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FinalizeEscapeGC</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">createBusyThread</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (<span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;,<span class="string">&quot;testBusyThread&quot;</span>);</span><br><span class="line">        thread.start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">createLockThread</span><span class="params">(<span class="keyword">final</span> Object lock)</span> &#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">synchronized</span> (lock) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        lock.wait();</span><br><span class="line">                    &#125;<span class="keyword">catch</span> (InterruptedException e)&#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;,<span class="string">&quot;testLockThread&quot;</span>);</span><br><span class="line">        thread.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">bufferedReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));</span><br><span class="line">        bufferedReader.readLine();</span><br><span class="line">        createBusyThread();</span><br><span class="line">        bufferedReader.readLine();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">object</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">        createLockThread(object);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  程序运行后，首先在“线程”页签中选择main线程，如图4-7所示。堆栈追踪显示 BufferedReader在readBytes方法中等待System.in的键盘输入，这时候线程为Runnable 状态，Runnable状态的进程会被分配运行时间，但readBytes方法检査到流没有更新时 会立刻归还执行令牌，这种等待只消耗很小的CPU资源。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8819%EF%BC%89.png"></p><p>  接着监控testBusyThread线程，如图4-8所示，testBusyThread线程一直在执行空循 环，从堆栈追踪中可以看到一直停留在FinalizeEscapeGC.java代码的12行，12行为while (true)„这时候线程为Runnable状态，而目.没有归还线程执行令牌的动作，会在空循环上用尽全部执行时间直到线程切换，这种等待会消耗较多的CPU资源。</p><p>  图4-9显示testLockThread线程在等待着lock对象的notify或notifyAll方法的出 现，线程这时候处在WAITING状态，在被唤醒前不会被分配执行时间。</p><p>  testLockThread线程正处于正常的活锁等待状态，只要lock对象的notify()或 notifyAlR)方法被调用，这个线程便能激活以继续执行。代码清单4-8演示了一个无法 再被激活的死锁等待。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8820%EF%BC%89.png"></p><center>图 4-8</center><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8821%EF%BC%89.png"></p><center>图 4-9</center><p>  代码清单4-8死锁代码样例</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.intehel.demo.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FinalizeEscapeGC</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">    <span class="type">int</span> a,b;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FinalizeEscapeGC</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.a = a;</span><br><span class="line">        <span class="built_in">this</span>.b = b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (Integer.valueOf(a))&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (Integer.valueOf(b))&#123;</span><br><span class="line">                System.out.println(a+b);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">FinalizeEscapeGC</span>(<span class="number">1</span>,<span class="number">2</span>)).start();</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">FinalizeEscapeGC</span>(<span class="number">2</span>,<span class="number">1</span>)).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  这段代码开了 200个线程分别去计算1+2及2+1的值，其实for循环是可省略的， 两个线程也可能会导致死锁，不过那样概率太小，需要尝试运行很多次才能看到效果。 如果运气不是特别差的话，带for循环的版本最多运行2~3次就会遇到线程死锁，程序无法结束。造成死锁的原因是Integer.valueOf()方法基于减少对象创建次数和节省内 存的考虑，［-128,127］之间的数字会被缓存。当valueOf()方法在这个范围之内传入参 数，将直接返回缓存中的对象。也就是说代码中调用了 200次Integer.valueOf()方法一 共就只返回了两个不同的对象。假如在某个线程的两个synchronized块之间发生了一次线程切换，就会出现线程A等着被线程B持有的Integer.valueOf(1),线程B又等着被线 程A持有的Integer.valueOf(2),结果大家都跑不下去的情景。</p><p>  出现线程死锁之后，点击JConsole线程面板的“检测到死锁”的按钮，将出现一个 新的”死锁”页签，如图4-10所示。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8822%EF%BC%89.png"></p><center>图 4-10</center><p>  图中很清晰地显示线程Thread-127在等待一个被线程Thread-158持有Integer对象， 而点击线程Thread-58则显示它也在等待一个Integer对象，被线程Thread-127持有，这样两个线程就互相卡住，都不存在等到锁释放的希望了。</p><h2 id="3-2-VisualVM-多合一故障处理工具"><a href="#3-2-VisualVM-多合一故障处理工具" class="headerlink" title="3.2  VisualVM :多合一故障处理工具"></a>3.2 VisualVM :多合一故障处理工具</h2><p>VisualVM （All-in-One Java Troubleshooting Tool）是到目前为止，随 JDK 发布的功能最强大的运行监视和故障处理程序，并且可以预见在未来一段时间内都是官方主力发展的虚拟机故障处理工具。官方在VisualVM的软件说明中写上了 “All-in-One”的描述 字样，预示着它除了运行监视、故障处理外，还提供了很多其他方面的功能。如性能分析（Profiling）, VisualVM的性能分析功能甚至比起JProfiler、YourKit等专业且收费的 Profiling 工具都不会逊色多少，而且VisualVM的还有一个很大优点：不需要被监视的 程序基于特殊Agent运行，因此它对应用程序的实际性能的影响很小，使得它可以直接 应用在生产环境中。这个优点是JProfiler、YourKit等工具无法与之媲美的。</p><h3 id="（1）VisualVM兼容范围与插件安装"><a href="#（1）VisualVM兼容范围与插件安装" class="headerlink" title="（1）VisualVM兼容范围与插件安装"></a>（1）VisualVM兼容范围与插件安装</h3><p>VisualVM基于NetBeans平台开发，因此它一开始就具备了插件扩展功能的特性， 通过插件扩展支持，VisualVM可以做到：</p><ul><li>显示虚拟机进程及进程的配置和环境信息（jps、jinfo）。</li><li>监视应用程序的CPU、GC、堆、方法区及线程的信息（jstat、jstack）。</li><li>dump及分析堆转储快照（jmap、jhat）。</li><li>方法级的程序运行性能分析，找出被调用最多、运行时间最长的方法。</li><li>离线程序快照：收集程序的运行时配置、线程dump、内存dump等信息建立一个 快照，可以将快照发送开发者处进行Bug反馈。</li><li>其他plugins的无限的可能性……</li></ul><p>  VisualVM在JDK 1.6 update 7中才首次出现，但并不意味着它只能监控运行于JDK 1.6上的程序，它具备很强的向下兼容能力，甚至能向下兼容至近10年前发布的JDK 1.4.2平台气这对无数已经处于实施、维护状态的项目很有意义。当然，并非所有的功 能都能完美地向下兼容，主要特性的兼容性如表4-6所示。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8823%EF%BC%89.png"></p><p>  首次启动VisualVM后，读者先不必着急找应用程序进行监测，因为现在VisualVM 还没有加载任何插件，虽然基本的监视、线程面板的功能主程序都以默认插件的形式提供了，但是不给VisualVM装任何扩展插件，就相当于放弃了它最精华的功能，和没有安装任何应用软件操作系统差不多。</p><p>  插件可以手工安装，在网站’上下载*.nbm包后，点击“工具”一“插件”一“已下载”菜单，然后在弹出的对话框中指定nbm包路径便可进行安装，插件安装后存放 在JDK HOME&#x2F;lib&#x2F;visualvm&#x2F;visualvm中。不过手工安装并不常用，使用VisualVM的 自动安装功能已经可以找到所需的大多数插件，在有网络连接的环境下，点击“工具-插件-菜单“，弹出如图4-11所示的插件页签，在页签的“可用插件”中列举了当前版本VisualVM可以使用的插件，选中插件后在右边窗口将显示这个插件的基本信 息，如开发者、版本、功能描述等。</p><p>  大家可以根据自己的工作需要和兴趣选择合适的插件，然后点击安装按钮，弹出如 图4-12所示的下载进度窗口，跟着提示操作稍后即可安装完成。</p><p>  安装完插件后，选择一个需要监视的程序就进入程序的主界面了，如图4-13所示。 根据读者选择安装插件数量的不同，看到的页签可能和笔者截图中的会有差异。</p><p>  VisualVM中“概述”、”监视”、”线程”、”MBeans”的功能与前面介绍的JConsole 差别不大，读者根据上一节的内容类比使用即可，下面挑选几个特色功能和插件进行 介绍。</p><h3 id="（2）生成和浏览堆转储快照"><a href="#（2）生成和浏览堆转储快照" class="headerlink" title="（2）生成和浏览堆转储快照"></a>（2）生成和浏览堆转储快照</h3><p>在VisualVM中生成dump文件有两种方式，可以执行下列任一操作：</p><ul><li>在“应用程序”窗口中右键单击应用程序节点，然后选择“堆Dump”。</li><li>在“应用程序”窗口中双击应用程序节点以打开应用程序标签，然后在“监视” 标签中单击“堆Dump”。</li></ul><p>  生成了 dump文件之后，应用程序页签将在该堆的应用程序下增加一个以 [heapdump]开头的子节点，并且在主页签中打开该转储快照，如图4-14所示。如果需 要把dump文件保存或发送出去，要在heapdump节点上右键选择“另存为”菜单，否 则当VisualVM关闭时，生成的dump文件会被当做临时文件被删除掉。要打开一个 已经存在的dump文件，通过文件菜单中的“装入”功能，选择硬盘上的dump文件 即可。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8824%EF%BC%89.png"></p><center>图 4-14</center><p>  从堆页签中的“摘要”面板可以看到应用程序dump时的运行时参数、System. getProperties()的内容、线程堆栈等信息，“类”面板则是以类为统计口径统计类的实例 数量和容量信息，”实例”面板不能直接使用，因为不能确定用户想査看哪个类的实例， 所以需要通过“类”面板进入，在“类”中选择一个关心的类后双击鼠标，即可在“实 例”中看见此类中500个实例的具体属性信息。“OQL控制台”面板里面就是运行OQL 査询语句的，同jhat里面介绍的OQL功能一样。</p><h3 id="（3）分析程序性能"><a href="#（3）分析程序性能" class="headerlink" title="（3）分析程序性能"></a>（3）分析程序性能</h3><p>在Profiler页签中，VisualVM提供了程序运行期间方法级的CPU执行时间分析及 内存分析，进行Profiling分析肯定会对程序运行性能有比较大的影响，所以一般不在生 产环境中使用这项功能。</p><p>要开始分析，先选择“CPU”和“内存”按钮中的一个，然后切换到应用程序中对程序进行操作，VisualVM会记录到这段时间中应用程序执行过的方法。如果是CPU分 析，将会统计每个方法的执行次数、执行耗时；如果是内存分析则会统计每个方法关联 的对象数及这些对象所占的空间。分析结束后，点击“停止”按钮结束监控过程，如图 4-15所示。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8825%EF%BC%89.png"></p><center>图 4-15</center><p>  注意 在JDK 1.5之后，在Client模式下的虚拟机加入并且自动开启了类共享——这是 一个在多虚拟机进程中共享rt.jar中的类数据以提高加载速度和节省内存的优化，而根 据相关Bug报告的反映，VisualVM的Profiler功能可能会因为类共享而导致被监视的应 用程序崩潰，所以读者进行Profiling前，最好在被监视的程序中使用-Xshare:off参数来 关闭类共享优化。</p><p>  图4-15中是对Eclipse IDE 一段操作的录制和分析结果，读者分析自己的应用程序时, 可以根据实际业务的复杂程度与方法的时间和调用次数做比较，找到最有优化价值的方法。</p><h3 id="（4）BTrace动态日志跟踪"><a href="#（4）BTrace动态日志跟踪" class="headerlink" title="（4）BTrace动态日志跟踪"></a>（4）BTrace动态日志跟踪</h3><p>BTrace®是一个很“有趣”的VisualVM插件，本身也是可以独立运行的程序。它的作用是在不停止目标程序运行的前提下，通过HotSpot虚拟机的HotSwap技术®动态加入 原本并不存在的调试代码。这项功能对实际生产中的程序很有意义：经常遇到程序出现问 题，但排査错误的一些必要信息，譬如方法参数、返回值等，在开发时并没有打印到日志 之中，以至于不得不停掉服务，通过调试增量来加入日志代码以解决问题。当遇到生产环 境服务无法随便停止时，缺一两句日志导致排错进行不下去是一件非常郁闷的事情。</p><p>  在VisualVM中安装了 BTrace插件后，应用程序面板右键点击要调试的程序，会出 现“Trace Application”菜单，点击将进入BTrace面板。这个面板里面看起来就像一个 简单的Java程序开发环境，里面还有一小段Java代码，如图4-16所示。</p><p><img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8826%EF%BC%89.png"></p><center>图 4-16</center><p>  准备了一段很简单的Java代码来演示BTrace的功能：产生两个1000以内的随机整数，输出这2个数字相加的结果，如代码清单4-9所示。</p><p>  代码清单4-9 BTrace跟踪演示</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.intehel.demo.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FinalizeEscapeGC</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="type">FinalizeEscapeGC</span> <span class="variable">finalizeEscapeGC</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FinalizeEscapeGC</span>();</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            reader.readLine();</span><br><span class="line">            <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> (<span class="type">int</span>) Math.round(Math.random()*<span class="number">1000</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> (<span class="type">int</span>) Math.round(Math.random()*<span class="number">1000</span>);</span><br><span class="line">            System.out.println(finalizeEscapeGC.add(a, b));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  程序运行后，在VisualVM中打开该程序的监视，在BTrace页签填充TracingScript 的内容，输入调试代码如代码清单4.10所示。</p><p>  代码清单4・10 BTrace调试代码</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* BTrace Script Template */</span></span><br><span class="line"><span class="keyword">import</span> com.sun.btrace.annotations.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.sun.btrace.BTraceUtils.*;</span><br><span class="line"><span class="meta">@BTrace</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TracingScript</span> &#123;</span><br><span class="line">	<span class="comment">/* put your code here */</span></span><br><span class="line">    <span class="meta">@OnMethod(</span></span><br><span class="line"><span class="meta">        clazz = &quot;com.intehel.demo.domain.FinalizeEscapeGC&quot;,</span></span><br><span class="line"><span class="meta">        method=&quot;add&quot;,</span></span><br><span class="line"><span class="meta">        location=@Location(Kind.RETURN)</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">func</span><span class="params">(<span class="meta">@Self</span> com.intehel.demo.domain.FinalizeEscapeGC instance,<span class="type">int</span> a,<span class="type">int</span> b,<span class="meta">@Return</span> <span class="type">int</span> result)</span>&#123;</span><br><span class="line">        println(<span class="string">&quot;调用堆栈：&quot;</span>);</span><br><span class="line">        jstack();</span><br><span class="line">        println(strcat(<span class="string">&quot;方法参数A:&quot;</span>,str(a)));</span><br><span class="line">        println(strcat(<span class="string">&quot;方法参数B:&quot;</span>,str(b)));</span><br><span class="line">        println(strcat(<span class="string">&quot;方法结果:&quot;</span>,str(result)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  点击“Start”按钮后稍等片刻，编译完成后，可见Output面板中出现“BTrace code successfuly deployed”的字样。程序运行的时候在Output面板将会输出如图4-17所示的 调试信息。</p><p>  <img src="https://image.buretuzi.online/blog/article/jvm/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)%EF%BC%8827%EF%BC%89.png"></p><center>图 4-17</center><p>  BTrace的用法还有许多，打印调用堆栈、参数、返回值只是最基本的应用，在它的网站上有使用BTrace进行性能监视、定位连接泄漏、内存泄漏、解决多线程竞争问题等的使用例子，有兴趣的可以去网上了解相关信息。</p><h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>本章介绍了随JDK发布的6个命令行工具与2个可视化的故障处理工具，灵活使用 这些工具，可以给处理问题带来很大的便利。</p><p>  除了 JDK自带的工具之外，常用的故障处理工具还有很多，如果读者使用的是非Sun系列的JDK,非HotSpot的虚拟机，就需要使用对应的工具进行分析，如：</p><ul><li>IBM 的 Support Assistant’、Heap Analyzer®, Javacore Analyzer®, Garbage Collector Analyzer®适用于 IBM J9 VM„</li><li>HP 的 HPjmeter®、HPjtune 适用于 HP-UX, SAP、HotSpot VM.</li><li>Eclipse 的 Memory Analyzer Tool® (MAT)适用于 HP-UX、SAP、HotSpot VM, 安装IBM DTFjo插件后可支持IBM J9 VM。</li><li>BEA 的 JRockit Mission Control ®,适用于 JRockit VMO</li></ul></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="http://blog.buretuzi.online">李文若</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="http://blog.buretuzi.online/2022/08/18/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)/">http://blog.buretuzi.online/2022/08/18/JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7(3)/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://blog.buretuzi.online" target="_blank">清河水温龙井茶</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JVM/">JVM</a></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async src="https://static.addtoany.com/menu/page.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/08/18/JVM%E8%B0%83%E4%BC%98%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90(4)/"><img class="prev-cover" src="https://image.buretuzi.online/blog/article/article-background/wallhaven-zyxe8j.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">JVM调优案例分析(4)</div></div></a></div><div class="next-post pull-right"><a href="/2022/08/18/java%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5(2)/"><img class="next-cover" src="/img/1.webp" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">java垃圾收集器与内存分配策略(2)</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/08/17/JVM%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%E4%B8%8E%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E5%BC%82%E5%B8%B8(1)/" title="JVM内存区域与内存溢出异常(1)"><img class="cover" src="https://image.buretuzi.online/blog/article/article-background/wallhaven-zyxrkv.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-17</div><div class="title">JVM内存区域与内存溢出异常(1)</div></div></a></div><div><a href="/2022/08/18/JVM%E8%B0%83%E4%BC%98%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90(4)/" title="JVM调优案例分析(4)"><img class="cover" src="https://image.buretuzi.online/blog/article/article-background/wallhaven-zyxe8j.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-18</div><div class="title">JVM调优案例分析(4)</div></div></a></div><div><a href="/2022/08/18/java%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5(2)/" title="java垃圾收集器与内存分配策略(2)"><img class="cover" src="/img/1.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-18</div><div class="title">java垃圾收集器与内存分配策略(2)</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div><div id="comment-switch"><span class="first-comment">Twikoo</span><span class="switch-btn"></span><span class="second-comment">Valine</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/head.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">李文若</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">48</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/luaby"><i class="fab fa-github"></i><span>My GitHub</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/luaby" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:liwenruo87@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Doro喜欢吃 欧润吉</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">1.概述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-JDK%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7"><span class="toc-number">2.</span> <span class="toc-text">2. JDK的命令行工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-jps-%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BF%9B%E7%A8%8B%E7%8A%B6%E5%86%B5%E5%B7%A5%E5%85%B7"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 jps :虚拟机进程状况工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-jstat-%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BB%9F%E8%AE%A1%E4%BF%A1%E6%81%AF%E7%9B%91%E8%A7%86%E5%B7%A5%E5%85%B7"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 jstat:虚拟机统计信息监视工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-jinfo-Java%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E5%B7%A5%E5%85%B7"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 jinfo : Java配置信息工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-jmap-Java%E5%86%85%E5%AD%98%E6%98%A0%E5%83%8F%E5%B7%A5%E5%85%B7"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 jmap : Java内存映像工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-jhat%EF%BC%9A%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%A0%86%E8%BD%AC%E5%82%A8%E5%BF%AB%E7%85%A7%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 jhat：虚拟机堆转储快照分析工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-jstack-Java%E5%A0%86%E6%A0%88%E8%B7%9F%E8%B8%AA%E5%B7%A5%E5%85%B7"><span class="toc-number">2.6.</span> <span class="toc-text">2.6 jstack : Java堆栈跟踪工具</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-JDK%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B7%A5%E5%85%B7"><span class="toc-number">3.</span> <span class="toc-text">3. JDK的可视化工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-JConsole-Java%E7%9B%91%E8%A7%86%E4%B8%8E%E7%AE%A1%E7%90%86%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 JConsole : Java监视与管理控制台</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E5%90%AF%E5%8A%A8-JConsole"><span class="toc-number">3.1.1.</span> <span class="toc-text">（1）启动 JConsole</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E5%86%85%E5%AD%98%E7%9B%91%E6%8E%A7"><span class="toc-number">3.1.2.</span> <span class="toc-text">（2）内存监控</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E7%BA%BF%E7%A8%8B%E7%9B%91%E6%8E%A7"><span class="toc-number">3.1.3.</span> <span class="toc-text">（3）线程监控</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-VisualVM-%E5%A4%9A%E5%90%88%E4%B8%80%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 VisualVM :多合一故障处理工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%881%EF%BC%89VisualVM%E5%85%BC%E5%AE%B9%E8%8C%83%E5%9B%B4%E4%B8%8E%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85"><span class="toc-number">3.2.1.</span> <span class="toc-text">（1）VisualVM兼容范围与插件安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E7%94%9F%E6%88%90%E5%92%8C%E6%B5%8F%E8%A7%88%E5%A0%86%E8%BD%AC%E5%82%A8%E5%BF%AB%E7%85%A7"><span class="toc-number">3.2.2.</span> <span class="toc-text">（2）生成和浏览堆转储快照</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E5%88%86%E6%9E%90%E7%A8%8B%E5%BA%8F%E6%80%A7%E8%83%BD"><span class="toc-number">3.2.3.</span> <span class="toc-text">（3）分析程序性能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%884%EF%BC%89BTrace%E5%8A%A8%E6%80%81%E6%97%A5%E5%BF%97%E8%B7%9F%E8%B8%AA"><span class="toc-number">3.2.4.</span> <span class="toc-text">（4）BTrace动态日志跟踪</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">4.</span> <span class="toc-text">小结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/05/13/exe%E6%B3%A8%E5%86%8C%E4%B8%BAwindows%E6%9C%8D%E5%8A%A1/" title="exe注册为windows服务"><img src="https://image.buretuzi.online/blog/article/article-background/wallhaven-2yed86.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="exe注册为windows服务"></a><div class="content"><a class="title" href="/2025/05/13/exe%E6%B3%A8%E5%86%8C%E4%B8%BAwindows%E6%9C%8D%E5%8A%A1/" title="exe注册为windows服务">exe注册为windows服务</a><time datetime="2025-05-13T17:06:18.000Z" title="发表于 2025-05-13 17:06:18">2025-05-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/13/UE4_2_operation/" title="2.UE4物体移动"><img src="https://image.buretuzi.online/ue4/095223-6245095744c07.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="2.UE4物体移动"></a><div class="content"><a class="title" href="/2025/04/13/UE4_2_operation/" title="2.UE4物体移动">2.UE4物体移动</a><time datetime="2025-04-13T10:16:00.000Z" title="发表于 2025-04-13 10:16:00">2025-04-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/11/UE4_1_operation/" title="1.UE4基础操作"><img src="https://image.buretuzi.online/ue4/095223-6245095744c07.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="1.UE4基础操作"></a><div class="content"><a class="title" href="/2025/04/11/UE4_1_operation/" title="1.UE4基础操作">1.UE4基础操作</a><time datetime="2025-04-11T22:16:00.000Z" title="发表于 2025-04-11 22:16:00">2025-04-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/10/Linux%20%E6%90%AD%E5%BB%BAKMS/" title="Linux 搭建KMS"><img src="https://image.buretuzi.online/blog/article/article-background/wallhaven-x61vml.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Linux 搭建KMS"></a><div class="content"><a class="title" href="/2023/11/10/Linux%20%E6%90%AD%E5%BB%BAKMS/" title="Linux 搭建KMS">Linux 搭建KMS</a><time datetime="2023-11-10T10:43:12.000Z" title="发表于 2023-11-10 10:43:12">2023-11-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/10/Linux%20%E6%90%AD%E5%BB%BAOpenVPN/" title="Linux 搭建OpenVPN"><img src="https://image.buretuzi.online/blog/article/article-background/wallhaven-x61vml.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Linux 搭建OpenVPN"></a><div class="content"><a class="title" href="/2023/11/10/Linux%20%E6%90%AD%E5%BB%BAOpenVPN/" title="Linux 搭建OpenVPN">Linux 搭建OpenVPN</a><time datetime="2023-11-10T10:43:12.000Z" title="发表于 2023-11-10 10:43:12">2023-11-10</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer_deal"><a class="deal_link" href="" title="mail"><i class="iconfont icon-17"></i></a><a class="deal_link" href="" title="qq" target="_blank"><i class="iconfont icon-qq"></i></a><a class="deal_link" href="" title="CSDN" target="_blank"><i class="iconfont icon-csdn"></i></a><a class="deal_link" href="https://github.com/luaby" title="github" target="_blank"><i class="iconfont icon-github"></i></a><img class="footer_mini_logo entered loading" style="border-radius:50%" src="/img/彩虹.png" onclick="btf.scrollToDest(0,500)" title="返回顶部"><a class="deal_link" href="" title="QQ空间"><i class="iconfont icon-qzone"></i></a><a class="deal_link" href="" title="微信" target="_blank"><i class="iconfont icon-wechat"></i></a><a class="deal_link" href="" title="Twitter" target="_blank"><i class="iconfont icon-twitter"></i></a><a class="deal_link" href="" title="Telegram" target="_blank"><i class="iconfont icon-fasong"></i></a></div><div id="Jay-footer"><div class="footer-group"><h3 class="footer-title">直达</h3><div class="footer-links"><a class="footer-item" href="" target="_blank">我的主页</a><a class="footer-item" href="">音乐欣赏</a><a class="footer-item" href="">心灵港湾</a><a class="footer-item" href="">随机文章</a></div></div><div class="footer-group"><h3 class="footer-title">分类</h3><div class="footer-links"><a class="footer-item" href="">学习笔记</a><a class="footer-item" href="">魔改教程</a><a class="footer-item" href="">算法笔记</a><a class="footer-item" href="">语法教程</a></div></div><div class="footer-group"><h3 class="footer-title">关于</h3><div class="footer-links"><a class="footer-item" href="/about/">关于我</a><a class="footer-item" href="">博客统计</a><a class="footer-item" href="/archives/">文章归档</a><a class="footer-item" href="">更新记录</a></div></div><div class="footer-group"><h3 class="footer-title">友链</h3><div class="footer-links" id="friend-links-in-footer"><a class="footer-item" target="_blank" rel="noopener" href="https://anzhiy.cn/">安知鱼</a><a class="footer-item" target="_blank" rel="noopener" href="https://www.chuckle.top">轻笑Chuckle</a><a class="footer-item" target="_blank" rel="noopener" href="https://akilar.top/">Akilarの糖果屋</a><a class="footer-item" target="_blank" rel="noopener" href="https://yisous.xyz">Ariasaka</a></div></div><div class="footer-group"><h3 class="footer-title">协议</h3><div class="footer-links"><a class="footer-item" href="">隐私协议</a><a class="footer-item" href="">Cookie</a><a class="footer-item" href="">版权协议</a></div></div></div><!--#footer-banner--><!--        #footer-banner-tips--><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="nav-music"><div id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()">播放音乐</div><meting-js id="8703296584" server="tencent" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>复制</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="iconfont icon-baidu"></i><span>百度搜索</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>转到链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>粘贴</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>空降评论</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>复制本文地址</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>转到链接</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-music"><a class="rightMenu-item" id="menu-music-play" href="javascript:anzhiyu.musicToggle()"><i class="fas fa-play"></i><span>播放音乐</span></a><a class="rightMenu-item" id="menu-music-pause" href="javascript:anzhiyu.musicToggle()"><i class="fa-solid fa-pause"></i><span>暂停音乐</span></a><a class="rightMenu-item" href="javascript:anzhiyu.musicSkipBack()"><i class="fas fa-backward"></i><span>切换到上一首</span></a><a class="rightMenu-item" href="javascript:anzhiyu.musicSkipForward()"><i class="fas fa-forward"></i><span>切换到下一首</span></a><a class="rightMenu-item" target="_blank" rel="noopener" href="https://y.qq.com/n/ryqq/playlist/8703296584"><i class="fas fa-radio"></i><span>查看歌单</span></a><a class="rightMenu-item" href="javascript:anzhiyu.musicGetSingName()"><i class="fas fa-copy"></i><span>复制歌名</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="./#post-comment"><i class="fa fa-download"></i><span>保存图片</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>在新窗口打开</span></a><a class="rightMenu-item" href="javascript:rmf.click()"><i class="fa fa-arrows-alt"></i><span>全屏显示</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制图片链接</span></a></div><div class="rightMenu-group rightMenu-line" id="common"><a class="rightMenu-item" href="javascript:toRandomPost()"><i class="fa fa-paper-plane"></i><span>随便逛逛</span></a><a class="rightMenu-item" href="javascript:rmf.switchDarkMode();"><i class="fa fa-moon"></i><span>昼夜切换</span></a><a class="rightMenu-item" href="javascript:rmf.translate();"><i class="iconfont icon-fanti"></i><span>繁简转换</span></a><a class="rightMenu-item" href="javascript:rmf.switchReadMode();"><i class="fa fa-book"></i><span>阅读模式</span></a><a class="rightMenu-item" href="javascript:window.location.href=&quot;/about/&quot;;"><i class="fa fa-info-circle"></i><span>版权声明</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/pluginsSrc/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/pluginsSrc/instant.page/instantpage.js" type="module"></script><script src="/pluginsSrc/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/pluginsSrc/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{const o=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo.buretuzi.online/",region:"",onCommentLoaded:function(){btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null))},t=()=>{"object"!=typeof twikoo?getScript("/pluginsSrc/twikoo/dist/twikoo.all.min.js").then(o):setTimeout(o,0)};t()})()</script><script>function loadValine(){function n(){new Valine(Object.assign({el:"#vcomment",appId:"0onZJ2E9cHeXWot3kJWDdrfM-gzGzoHsz",appKey:"ghd4PqqDJfdNbcH3JZEGwl4A",avatar:"mp",serverURLs:"",emojiMaps:"",path:window.location.pathname,visitor:!0}))}"function"==typeof Valine?n():getScript("/pluginsSrc/valine/dist/Valine.min.js").then(n)}{function loadOtherComment(){loadValine()}setTimeout(loadValine,0)}</script></div><div class="aplayer no-destroy" data-id="1708664797" data-server="tencent" data-type="playlist" data-order="list" data-fixed="true" data-preload="auto" data-autoplay="false" data-mutex="true"></div><script src="/js/cursor.js"></script><script src="/js/sakura.js"></script><script src="/js/Progressbar.js"></script><script async data-pjax src="/js/navigation.js"></script><script src="/js/jquery.min.js"></script><script src="/js/rightmenu.js"></script><script src="/js/title.js"></script><script src="/js/player/anzhiyu.js"></script><script src="/js/player/anzhiyufunction.js"></script><script src="/js/winbox.bundle.min.js"></script><canvas class="fireworks" mobile="true"></canvas><script src="/pluginsSrc/butterfly-extsrc/dist/fireworks.min.js"></script><script defer id="fluttering_ribbon" mobile="true" src="/pluginsSrc/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script src="/pluginsSrc/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!0,document.body.addEventListener("input",POWERMODE)</script><link rel="stylesheet" href="/css/player/APlayer.min.css" media="print" onload='this.media="all"'><script src="/js/player/APlayer.min.js"></script><script src="/js/player/Meting2.min.js"></script><script src="/pluginsSrc/pjax/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.tocScrollFn&&window.removeEventListener("scroll",window.tocScrollFn),window.scrollCollect&&window.removeEventListener("scroll",scrollCollect),document.getElementById("rightside").style.cssText="opacity: ''; transform: ''",window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script></div><div class="contact-info"><div class="option"><i class="fas fa-heart"></i><div class="bloktop"></div><div class="text">或许不该心动<div class="strip"></div></div></div><div class="option"><i class="fas fa-commenting"></i><div class="blok"></div><div class="text">要和我说悄悄话吗？<div class="strip"></div></div></div><div class="option"><i class="fas fa-hourglass-2"></i><div class="blokbottom"></div><div class="text">人生匆匆，何必拘泥过往<div class="strip"></div></div></div></div><script data-pjax>function butterfly_categories_card_injector_config(){var a=document.getElementById("recent-posts");console.log("已挂载butterfly_categories_card"),a.insertAdjacentHTML("afterbegin",'<style>li.categoryBar-list-item{width:24%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(/img/1.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/java/&quot;);" href="javascript:void(0);">java</a><span class="categoryBar-list-count">41</span><span class="categoryBar-list-descr">技术</span></li><li class="categoryBar-list-item" style="background:url(/img/2.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/windows/&quot;);" href="javascript:void(0);">windows</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(/img/3.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/Linux/&quot;);" href="javascript:void(0);">Linux</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(/img/4.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/UE4/&quot;);" href="javascript:void(0);">UE4</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr"></span></li></ul></div></div>')}document.getElementById("recent-posts")&&"/"===location.pathname&&butterfly_categories_card_injector_config()</script><script data-pjax>function butterfly_clock_anzhiyu_injector_config(){var e=document.getElementById("card-widget");console.log("已挂载butterfly_clock_anzhiyu"),e&&e.insertAdjacentHTML("afterbegin",'<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="/img/clock.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>')}for(var elist="null".split(","),cpage=location.pathname,epage="all",qweather_key="077e8d0195484e3a81fdbc5082aab008",gaud_map_key="af81a9f393f79a52e1deb75a2109d705",baidu_ak_key="undefined",flag=0,clock_rectangle="112.982279,28.19409",clock_default_rectangle_enable="false",i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_clock_anzhiyu_injector_config()</script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="/js/clock.min.js"></script><script data-pjax>function butterfly_footer_beautify_injector_config(){var t=document.getElementById("footer-wrap");console.log("已挂载butterfly_footer_beautify"),t.insertAdjacentHTML("beforeend",'<p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title=""><img src="/img/footer/frame.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.2.2" title=""><img src="/img/footer/theme.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com" style="margin-inline:5px" data-title="本站使用Vercel作为静态托管平台" title=""><img src="/img/footer/host.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20229936" style="margin-inline:5px" data-title="本站已在萌进行备案" title=""><img src="/img/footer/萌备案.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://beian.miit.gov.cn" style="margin-inline:5px" data-title="本站已在豫进行备案" title=""><img src="/img/footer/豫备案.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://www.upyun.com/" style="margin-inline:5px" data-title="本站使用又拍云为静态资源提供CDN加速" title=""><img src="/img/footer/cdn.svg" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src="/img/footer/copyright.svg" alt=""/></a></p>')}for(var elist="null".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_footer_beautify_injector_config()</script><script data-pjax>function butterfly_swiper_injector_config(){var i=document.getElementById("recent-posts");console.log("已挂载butterfly_swiper"),i.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/07/17/异常处理- SpringBoot（11）/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://image.buretuzi.online/blog/article/article-background/wallhaven-3zj6l9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-07-17</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/07/17/异常处理- SpringBoot（11）/&quot;);" href="javascript:void(0);" alt="">异常处理- SpringBoot（11）</a><div class="blog-slider__text">你会爱我吗？</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/07/17/异常处理- SpringBoot（11）/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/08/18/java垃圾收集器与内存分配策略(2)/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/img/1.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-18</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/08/18/java垃圾收集器与内存分配策略(2)/&quot;);" href="javascript:void(0);" alt="">java垃圾收集器与内存分配策略(2)</a><div class="blog-slider__text">好吧就这样吧</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/08/18/java垃圾收集器与内存分配策略(2)/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}for(var elist="undefined".split(","),cpage=location.pathname,epage="/",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer src="/js/swiper/swiper.min.js"></script><script defer data-pjax src="/js/swiper/swiper_init.js"></script></body></html>